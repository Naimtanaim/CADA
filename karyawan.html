<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ID Card Generator</title>
<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
<style>
body {font-family:"Noto Sans TC", Arial, sans-serif; background:#f9f9f9; padding:20px;}
.form {margin-bottom:20px; background:#fff; padding:15px; border:1px solid #ccc; border-radius:8px;}
.form label{display:block; margin-top:10px; font-weight:bold;}
.form input, .form button{width:100%; padding:8px; margin-top:4px; box-sizing:border-box;}
.form button{margin-top:15px; font-weight:bold; cursor:pointer;}

/* Ukuran ID Card */
.card {
  width: 336px;
  height: 212px;
  border:2px solid #000;
  border-radius:10px;
  background:#fff;
  padding:10px;
  margin:auto;
  position:relative;
  box-sizing:border-box;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

.header {
  display:flex;
  align-items:center;
  margin-bottom:5px;
  position:relative; /* untuk logo bisa absolute */
}

.header .logo-container {
  position:absolute;
  top:0;
  left:0;
  cursor:grab;
}

.header .logo-container.dragging {
  cursor:grabbing;
}

.header .logo-container img {
  max-height:60px;
  display:block;
}

.company {font-size:22px; font-weight:bold; margin-left:70px;}
.company-en {font-size:17px; color:#555; margin-left:72px;}


.content {display:flex; margin-top:10px;}
.photo {width:80px; height:100px; border:1px solid #000; border-radius:4px; overflow:hidden;}
.photo img {width:100%; height:100%; object-fit:cover;}
.info {flex:2; padding-left:20px; font-size:20px; line-height:1.6;}

.barcode {
  position:absolute;
  bottom:10px;
  left:20;
  width:120%; /* full lebar kartu */
  text-align:center;
}
.barcode svg {
  width:100%; /* full width */
  height:35px;
}
.barcode-number {
  margin-top:2px;
  font-size:10px;
  font-weight:bold;
  width:100%;
  text-align:center;
}
    .company {
      display: inline-block;       /* biar ukurannya sesuai teks */
      border-bottom: 2px solid #333; /* garis bawah */
      padding: 2px 0;
    }

@media print {
  body{background:#fff;}
  .form{display:none;}
  .card{margin:0;}
}
</style>
</head>
<body>

<div class="form">
  <label>Nama Perusahaan (中文)</label>
  <input type="text" id="companyTw" value="益萊工業股份有限公司">

  <label>Nama Perusahaan (EN)</label>
  <input type="text" id="companyEn" value="CADA INDUSTRIAL CO.,LTD">

  <label>Nama (姓名)</label>
  <input type="text" id="name" value="">

  <label>Unit (單位)</label>
  <input type="text" id="dept" value="">

  <label>Kode Barcode</label>
  <input type="text" id="barcodeInput" value="">

  <label>Upload Logo</label>
  <input type="file" id="logoInput" accept="image/*">

  <label>Upload Foto</label>
  <input type="file" id="photoInput" accept="image/*">

  <button onclick="window.print()">Cetak</button>
</div>

<div class="card">
  <div class="header">
    <div class="logo-container" id="logoContainer">
      <img id="logo" src="" alt="LOGO">
    </div>
    <div>
      <div class="company" id="outCompanyTw">益萊工業股份有限公司</div>
      <div class="company-en" id="outCompanyEn">CADA INDUSTRIAL CO.,LTD</div>
    </div>
  </div>

  <div class="content">
    <div class="photo"><img id="outPhoto" src=""></div>
    <div class="info">
      <div>姓名：<span id="outName">阿杜</span></div>
      <div>單位：<span id="outDept">良英</span></div>
    </div>
  </div>

  <div class="barcode">
    <svg id="barcode"></svg>
    <div class="barcode-number" id="outBarcode">1080712301</div>
  </div>
</div>

<script>
const $ = id => document.getElementById(id);

function render(){
  $("outCompanyTw").textContent = $("companyTw").value;
  $("outCompanyEn").textContent = $("companyEn").value;
  $("outName").textContent = $("name").value;
  $("outDept").textContent = $("dept").value;

  const code = $("barcodeInput").value;
  $("outBarcode").textContent = code;
  JsBarcode("#barcode", code, {format:"CODE128", displayValue:false, width:2, height:35, margin:0});
}

["companyTw","companyEn","name","dept","barcodeInput"].forEach(id=>{
  $(id).addEventListener("input", render);
});

$("logoInput").addEventListener("change", e=>{
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = ev => $("logo").src = ev.target.result;
    reader.readAsDataURL(file);
  }
});

$("photoInput").addEventListener("change", e=>{
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = ev => $("outPhoto").src = ev.target.result;
    reader.readAsDataURL(file);
  }
});

render();

// Drag logo
const logoContainer = $("logoContainer");
let isDragging = false, offsetX, offsetY;

logoContainer.addEventListener("mousedown", e => {
  isDragging = true;
  logoContainer.classList.add('dragging');
  offsetX = e.offsetX;
  offsetY = e.offsetY;
});

document.addEventListener("mousemove", e => {
  if(!isDragging) return;
  const parentRect = logoContainer.parentElement.getBoundingClientRect();
  let x = e.clientX - parentRect.left - offsetX;
  let y = e.clientY - parentRect.top - offsetY;

  const maxX = parentRect.width - logoContainer.offsetWidth;
  const maxY = parentRect.height - logoContainer.offsetHeight;
  x = Math.max(0, Math.min(x, maxX));
  y = Math.max(0, Math.min(y, maxY));

  logoContainer.style.left = x + 'px';
  logoContainer.style.top = y + 'px';
});

document.addEventListener("mouseup", ()=>{ isDragging=false; logoContainer.classList.remove('dragging'); });
</script>
</body>
</html>
